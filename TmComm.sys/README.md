#### Installed drivers by the application

The RootkitBuster (beta) V5.0.0 Build 1212 from TrendMicro includes a kernel system driver `tmcomm.sys` which is prone to vulnerabilities via a referenced exposed IOCTL `0x9000402b`. 
Since this rootkit scanner has a `feature` to scan the Master Boot Record (MBR), an unprivileged used can corrupt some memory
Installing the RootKitBuster (beta) application loads a system driver, `tmcomm.sys`. When the application is in a running state, a secondary driver, `tmrkb.sys` is loaded.

The device symlink paths are

- \device\TmComm
- \tcmcomm.sys

#### Reverse engineering the vulnerability

IOCTL - Case 1 

`0x9000402b`

When enabling the MBR scanning option, this IOCTL will be used and can aprently write into memory. This is the first discovered vulnerability from within this driver.

#### IOCTL fuzzing

Multiple IOCTLs can be discovered in this applications dispatch table.

---

```
  Valid IOCTLs found
  ------------------
  0x900040e7    function code: 0x0039
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 44 (0x2c)

  0x900040df    function code: 0x0037
                transfer type: METHOD_NEITHER
                input bufsize: min = 358 (0x166) | max = 65535 (0xffff)

  0x900040db    function code: 0x0036
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 24 (0x18)

  0x90004063    function code: 0x0018
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 44 (0x2c)

  0x90004033    function code: 0x000c
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 24 (0x18)

  0x9000402f    function code: 0x000b
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 100 (0x64)

  0x9000402b    function code: 0x000a
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 76 (0x4c)

  0x90004027    function code: 0x0009
                transfer type: METHOD_NEITHER
                input bufsize: fixed size = 24 (0x18)
 ```

#### Reporting to vendor

Apr 14, 2020 -  Contacted vendor

#### Recommended remediation

- Currently the best remediation is to find another rootkit scanner
